#: import MDFloatLayout kivymd.uix.boxlayout.MDBoxLayout
#: import MDLabel kivymd.uix.label.MDLabel
#: import MDFloatLayout kivymd.uix.floatlayout.MDFloatLayout
#: import MDGridLayout kivymd.uix.gridlayout.MDGridLayout
#: import MDRoundFlatButton kivymd.uix.button.MDRoundFlatButton
#: import MapView kivy_garden.mapview.MapView
#: import MapMarker kivy_garden.mapview.MapMarker
#: import MDFillRoundFlatIconButton kivymd.uix.button.MDFillRoundFlatIconButton
#: import MDToolbar kivymd.uix.toolbar.MDToolbar
#: import MDIconButton kivymd.uix.button.MDIconButton
#: import MDFlatButton kivymd.uix.button.MDFlatButton
#: import MDTextFieldRound kivymd.uix.textfield.MDTextFieldRound
#: import MDRelativeLayout kivymd.uix.relativelayout.RelativeLayout

WindowManager:
	Onboard:
	RegistrationMain:
	RegistrationDop:
	Enter:
	EnterCheckPhone:
	GPSHelper:
	Menu:
	Rules:
	Penalties:
	CatalogFish:
	Recipes:
	User:
	Calendar:
	News:

<News>:
	name: 'News'
	color: (152, 152, 152, 1)

	MDBoxLayout:
		orientation: 'vertical'

		MDIconButton:
			icon: 'close'
			pos_hint: {'right': 1, 'center_y': 0.92}
			on_release: app.root.current = 'GPSHelper'

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Лента новостей"
			font_size: '30sp'
			bold: True

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Приносим извинения, страница в разработке"
			font_size: '14sp'

<Calendar>:
	name: 'Calendar'
	color: (152, 152, 152, 1)

	MDBoxLayout:
		orientation: 'vertical'

		MDIconButton:
			icon: 'close'
			pos_hint: {'right': 1, 'center_y': 0.92}
			on_release: app.root.current = 'GPSHelper'

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Календарь"
			font_size: '30sp'
			bold: True

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Приносим извинения, страница в разработке"
			font_size: '14sp'

<User>:
	name: 'User'
	color: (152, 152, 152, 1)

	MDBoxLayout:
		orientation: 'vertical'

		MDIconButton:
			icon: 'close'
			pos_hint: {'right': 1, 'center_y': 0.92}
			on_release: app.root.current = 'GPSHelper'

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Профиль пользователя"
			font_size: '30sp'
			bold: True

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Приносим извинения, страница в разработке"
			font_size: '14sp'

<Menu>:
	name: 'Menu'
	color: (152, 152, 152, 1)

	MDBoxLayout:
		orientation: 'vertical'
		
		MDIconButton:
			icon: 'close'
			pos_hint: {'right': 1, 'center_y': 0.92}
			on_release: app.root.current = 'GPSHelper'

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Меню"
			font_size: '30sp'
			bold: True

		MDFlatButton:
			font_size: '14sp'
			text: 'Каталог рыб'
			on_release: root.click_on_button_catalogFish()

		MDFlatButton:
			font_size: '14sp'
			text: 'Рецепты приготовления'
			on_release: root.click_on_button_recipes()

		MDFlatButton:
			font_size: '14sp'
			text: 'Правила рыбалки'
			on_release: root.click_on_button_rules()

		MDFlatButton:
			font_size: '14sp'
			text: 'Штрафы'
			on_release: root.click_on_button_penalties()

<Rules>:
	name: 'Rules'
	color: (152, 152, 152, 1)

	MDBoxLayout:
		orientation: 'vertical'

		MDIconButton:
			icon: 'close'
			pos_hint: {'right': 1, 'center_y': 0.92}
			on_release: app.root.current = 'Menu'

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Правила рыбалки"
			font_size: '30sp'
			bold: True

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Приносим извинения, страница в разработке"
			font_size: '14sp'

<Penalties>:
	name: 'Penalties'
	color: (152, 152, 152, 1)

	MDBoxLayout:
		orientation: 'vertical'
		
		MDIconButton:
			icon: 'close'
			pos_hint: {'right': 1, 'center_y': 0.92}
			on_release: app.root.current = 'Menu'

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Штрафы"
			font_size: '30sp'
			bold: True

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Приносим извинения, страница в разработке"
			font_size: '14sp'

<CatalogFish>:
	name: 'CatalogFish'
	color: (152, 152, 152, 1)

	listFish: listFish

	ScroollView:
		MDBoxLayout:
		
			MDIconButton:
				icon: 'close'
				pos_hint: {'right': 1, 'center_y': 0.92}
				on_release: app.root.current = 'Menu'

			MDLabel:
				font_style: 'Proxima Nova'			
				text: "Каталог рыб"
				font_size: '30sp'
				bold: True

			MDGridLayout:
				id: listFish
				cols: 2
				size_hint_x: 0.5
				size_hint_y: 0.3

				MDGridLayout:
					rows: 2

<Recipes>:
	name: 'Recipes'
	color: (152, 152, 152, 1)

	MDBoxLayout:
		orientation: 'vertical'
		
		MDIconButton:
			icon: 'close'
			pos_hint: {'right': 1, 'center_y': 0.92}
			on_release: app.root.current = 'Menu'

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Рецепты приготовления"
			font_size: '30sp'
			bold: True

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Приносим извинения, страница в разработке"
			font_size: '14sp'

<Onboard>:
	name: 'Onboard'
	color: (152, 152, 152, 1)

	MDRelativeLayout:
		FitImage:
			source: "resources/pictures/fish.png"

		MDLabel:
			text: 'Ваш гид по лучшим местам для рыбалки.'
			color: (1, 1, 1, 1)
			pos_hint: {'center_x' : 0.5 , 'center_y' : 0.30}
			font_style: 'Proxima Nova'
			font_size: '40sp'

		MDLabel:
			text: 'Ваш помощник и гид по лучшим местам для рыбалки.'
			font_style: 'Proxima Nova'
			pos_hint: {'center_x' : 0.5 , 'center_y' : 0.17}
			color: (170, 176, 190, 1)
			font_size: '16sp'
				
		MDFillRoundFlatButton:
			size_hint_x: 0.93
			pos_hint: {'center_x' : 0.5, 'y' : 0.025}
			text: "Начать"
			font_size: '20sp'
			on_release:
				app.root.current = 'Enter'

<RegistrationMain>:
	name: 'RegistrationMain'
	color: (152, 152, 152, 1)

	button_enter: button_enter	
	input_surname: input_surname
	input_name: input_name
	input_lastname: input_lastname
	input_mail: input_mail
	input_phone: input_phone
	
	MDBoxLayout:

		orientation: "vertical"
		padding: 50

		MDLabel:
			text: "Регистрация"
			font_style: 'Proxima Nova'
			font_size: '40sp'
			bold: True

		MDGridLayout:
			cols: 2

			AsyncImage:
				source: 'resources/pictures/user.png'
				size_hint: 0.05, 0.2

			MDTextField:
				font_style: 'Proxima Nova'
				id: input_surname
				hint_text: "Фамилия"
				multiline: False
				font_size: '30sp'

		MDGridLayout:
			cols: 2

			AsyncImage:
				source: 'resources/pictures/user.png'
				size_hint: 0.05, 0.2

			MDTextField:
				font_style: 'Proxima Nova'
				id: input_name
				hint_text: "Имя"
				multiline: False
				font_size: '30sp'

		MDGridLayout:
			cols: 2

			AsyncImage:
				source: 'resources/pictures/user.png'
				size_hint: 0.05, 0.2

			MDTextField:
				font_style: 'Proxima Nova'
				id: input_lastname
				hint_text: "Отчество"
				multiline: False
				font_size: '30sp'
		MDGridLayout:
			cols: 2

			AsyncImage:
				source: 'resources/pictures/email.png'
				size_hint: 0.05, 0.2

			MDTextField:
				font_style: 'Proxima Nova'
				id: input_mail
				hint_text: "Адрес эл.почты"
				multiline: False
				font_size: '30sp'

		MDGridLayout:
			cols: 2

			AsyncImage:
				source: 'resources/pictures/phone.png'
				size_hint: 0.05, 0.2

			MDTextField:
				font_style: 'Proxima Nova'
				id: input_phone
				hint_text: "+7 (___)___-__-__"
				multiline: False
				font_size: '30sp'
				input_type: 'number'
				input_filter: 'int'

		MDLabel:
			font_size: '14sp'
			text: 'Продолжая Вы соглашаетесь с нашими:'
			font_style: 'Proxima Nova'			

		MDFlatButton:
			font_size: '14sp'
			text: 'Условиями и Положениями'
			on_release: root.click_on_button_terms_and_agreements()
			theme_text_color: 'Custom'
			text_color: app.theme_cls.primary_color

		MDFlatButton:
			font_size: '14sp'
			text: 'Политикой конфидициальности'			
			on_release: root.click_on_button_privacy_policy()
			theme_text_color: 'Custom'
			text_color: app.theme_cls.primary_color

		MDFillRoundFlatButton:
			size_hint: 0.93, None
			pos_hint: {'center_x' : 0.5, 'y' : 0.1}
			text: "Регистрация"
			font_size: '30sp'
			on_release: root.click_on_button_register()

		MDGridLayout:
			cols: 2

			MDLabel:
				font_size: '14sp'
				text: 'Уже есть аккаунт?'
				font_style: 'Proxima Nova'			

			MDFillRoundFlatButton:
				id: button_enter
				font_size: '14sp'
				text: 'Войти'
				on_release: root.click_on_button_enter()

<RegistrationDop>:
	name: 'RegistrationDop'
	color: (152, 152, 152, 1)

	button_continue: button_continue
	
	MDBoxLayout:
		orientation: "vertical"

		MDFillRoundFlatIconButton:
			icon: 'arrow-left-bold-circle-outline'
			on_release:
				app.root.current = 'RegistrationMain'

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Условия и положения"
			font_size: '21sp'
			bold: True

		MDLabel:
			font_style: 'Proxima Nova'			
			text: '1.1. Пользуясь Мобильным приложением, Вы соглашаетесь с тем, что:'
			font_size: '16sp'
			bold: True

		MDLabel:
			font_style: 'Proxima Nova'			
			text: '1.1.1. Вы ознакомились с условиями настоящего Пользовательского соглашения в полном объёме до начала использования Мобильного приложения.'
			font_size: '13sp'

		MDLabel:
			font_style: 'Proxima Nova'			
			font_size: '13sp'
			text: '1.1.2. Начало использования Вами Мобильного приложения в любой форме означает, что Вы принимаете все условия настоящего Пользовательского соглашения в полном объёме без каких-либо изъятий и ограничений с Вашей стороны. Использование Мобильного приложения на иных условиях не допускается.'

		MDLabel:
			font_style: 'Proxima Nova'			
			font_size: '13sp'
			text: '1.1.3. Если Вы не согласны с условиями настоящего Пользовательского соглашения или не имеете права на его заключение, Вам следует незамедлительно прекратить любое использование Мобильного приложения.'

		MDLabel:
			font_style: 'Proxima Nova'			
			font_size: '13sp'
			text: '1.1.4. Пользовательское соглашение в любой форме означает, что Вы принимаете все условия настоящего Пользовательского соглашения.'

		MDGridLayout:
			cols: 2

			CheckBox:
				id: checkbox_agree
				on_active: root.click_on_checkbox_agree(self, self.active)

			MDLabel:
				font_style: 'Proxima Nova'
				font_size: '13sp'
				text: 'Я согласен с условиями'

		MDFillRoundFlatButton:
			id: button_continue
			size_hint: 0.93, 0.4
			pos_hint: {'center_x' : 0.5, 'y' : 0.1}
			text: "Продолжить"
			disabled: False

			on_release: root.click_on_button_continue()

<Enter>:
	name: 'Enter'

	input_phone: input_phone

	MDBoxLayout:
		orientation: "vertical"
		padding: 15
		background_color: (152/255, 152/255, 152/255, 1/255)

		canvas:
			Color:
				rgba: 152/255, 152/255, 152/255, 1/255
			Rectangle:
				size: self.size
				pos: self.pos

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Войти"
			font_size: '40sp'
			bold: True

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Для авторизации введите Ваш номер телефона"
			#pos_hint: {'center_y' : 0.3}
			font_size: '30sp'

		MDGridLayout:
			cols: 2
			size_hint_y: .3
			size_hint_x: .93
			pos_hint: None
			pos_hint: {'y': 0.5}

			AsyncImage:
				source: 'resources/pictures/phone.png'
				size_hint: 0.05, 0.1

			MDTextField:
				id: input_phone
				font_style: 'Proxima Nova'
				hint_text: "+7 (___)___-__-__"
				multiline: False
				font_size: '38sp'
				input_type: 'number'
				input_filter: 'int'

		MDFillRoundFlatButton:
			size_hint_x: 0.93
			pos_hint: {'center_x' : 0.5, 'y' : 0.025}
			text: "Вход"
			font_size: '30sp'

			on_release: root.click_on_button_enter()

		MDGridLayout:
			size_hint_y: .1
			cols: 2

			MDLabel:
				font_style: 'Proxima Nova'			
				text: "Нет аккаунта?"
				font_size: '14sp'

			MDFlatButton:
				font_size: '14sp'
				text: 'Регистрация'
				theme_text_color: 'Custom'
				text_color: app.theme_cls.primary_color
				on_release: root.click_on_button_register()

<EnterCheckPhone>:
	name: 'EnterCheckPhone'

	label_phone: label_phone
	input_code: input_code

	MDBoxLayout:
		orientation: "vertical"
		padding: 15

		MDLabel:
			font_style: 'Proxima Nova'			
			text: "Проверка номера"
			font_size: '40sp'
			bold: True

		MDLabel:
			font_size: '14sp'
			font_style: 'Proxima Nova'			
			text: 'Мы отправили код подтверждения на номер: '

		MDLabel:
			id: label_phone
			font_style: 'Proxima Nova'			
			font_size: '14sp'
			text: ''
			theme_text_color: 'Custom'
			text_color: app.theme_cls.primary_color
			markup: True

		MDLabel:
			font_style: 'Proxima Nova'			
			font_size: '14sp'
			text: 'Введите полученный код'
			
		MDTextField:
			font_style: 'Proxima Nova'			
			id: input_code
			multiline: False
			font_size: '30sp'
			input_type: 'number'
			input_filter: 'int'


		MDFillRoundFlatButton:
			size_hint_x: 0.93
			pos_hint: {'center_x' : 0.5, 'y' : 0.025}
			text: "Подтвердить"
			font_size: '30sp'

			on_release: root.click_on_button_confirm()

<GPSHelper>:
	name: 'GPSHelper'

	input_search: input_search

	MapView:


		lat: 47.99296606506406
		lon: 45.895986557006836
		zoom: 14
		map_source: "osm"

		# Fixed the maximum zoom out to 12
		on_zoom: self.zoom = 14 if self.zoom < 14 else self.zoom
    	# Attempt of fixing the MapMarker size when zooming

		MapMarker:
    		id: map_marker_id
    		source: 'resources/pictures/marker.png'
    		lat: 47.995390
    		lon: 45.853030
    		size_hint: (None, None)
    		size: [50, 50]	

	MDBottomAppBar:

		MDToolbar:
			#size_hint: .93, None
			#pos_hint: {'center_x' : 0.5, 'y' : 0.1}
			left_action_items: [['map-marker-outline', lambda x: root.click_on_button_gps()], ['note-text-outline', lambda x: root.click_on_button_note()]]
			right_action_items: [['calendar-month', lambda x: root.click_on_button_calendar()], ['account', lambda x: root.click_on_button_user()]]
			icon: 'plus-circle'
			on_action_button: root.click_on_button_plus()
			type: 'bottom'
			mode: 'center'

	MDFloatLayout:

		MDIconButton:
			icon: 'fish'
			pos_hint: {'right' : 1, 'center_y' : 0.45}
			on_release: root.click_on_button_fish()

		MDIconButton:
			icon: 'crosshairs-gps'
			pos_hint: {'right' : 1, 'center_y' : 0.5}
			on_release: root.click_on_button_userGps()

		MDIconButton:
			icon: 'layers-triple-outline'
			pos_hint: {'right' : 1, 'center_y' : 0.92}
			on_release: root.click_on_button_layers()

		# Image:
		# 	source: 'resources/pictures/search/png'
		# 	size_hint: {.1, .1}
		# 	allow_stretch: True

		MDTextField:
			hint_text: 'Найти место или адрес'
			font_style: 'Proxima Nova'
			size_hint_x: .7
			pos_hint: {'right': 0.8, 'center_y' : 0.96}			
			id: input_search
			multiline: False
			font_size: '30sp'
			icon_right: 'magnify'
